title: zipapp - ƒë√≥ng g√≥i app Python v√†o 1 file zip ch·∫°y ƒë∆∞·ª£c
date: 2022-09-28
modified: 2022-09-28
tags: zip, zipapp
category: news
slug: zipapp
authors: Pymier0
description: kh√¥ng h·ªÅ m·ªõi, c√≥ t·ª´ Python2.6 (2008), nh∆∞ng √≠t ƒë∆∞·ª£c bi·∫øt t·ªõi

![img](https://images.unsplash.com/photo-1623985153974-70b07d6a279e?ixlib=rb-1.2.1&dl=fidel-fernando-fopwDMRoOlE-unsplash.jpg&w=640&q=80&fm=jpg&crop=entropy&cs=tinysrgb)

Code Python c√≥ th·ªÉ ƒë∆∞·ª£c ƒë√≥ng trong 1 file zip v√† ch·∫°y ƒë∆∞·ª£c (nh∆∞ file .exe tr√™n Windows). V√≠ d·ª• ƒë∆°n gi·∫£n tr√™n Ubuntu:

```sh
$ mkdir ziptest
$ echo 'print("Hello Pymier")' > ziptest/__main__.py
$ python3 -m zipapp ziptest
$ ls -l ziptest.pyz
-rw-rw-r-- 1 hvn hvn 142 Sep 28 21:24 ziptest.pyz
$ file ziptest.pyz
ziptest.pyz: Zip archive data, at least v2.0 to extract
$ zipinfo ziptest.pyz
Archive:  ziptest.pyz
Zip file size: 142 bytes, number of entries: 1
-rw-rw-r--  2.0 unx       22 b- stor 22-Sep-28 21:20 __main__.py
1 file, 22 bytes uncompressed, 22 bytes compressed:  0.0%
$ python ziptest.pyz
Hello Pymier
```

Code trong file `__main__.py` s·∫Ω ƒë∆∞·ª£c ch·∫°y.


### Ch·ªâ l√† 1 file zip
Vi·ªác t·∫°o file zip n√†y kh√¥ng c·∫ßn b·∫•t c·ª© tool g√¨ ƒë·∫∑t bi·ªát, ch·ªâ c·∫ßn t·∫°o 1 file zip ch·ª©a file `__main__.py` (v√† N file kh√°c n·∫øu c·∫ßn) l√† ƒë∆∞·ª£c.

T√†i li·ªáu c·ªßa Python lib zipapp c√≥ gi·∫£i th√≠ch format n√†y, ch√∫ √Ω r·∫±ng file zip c√≥ header ·ªü ch·ªó n√†o c≈©ng ƒë∆∞·ª£c (ch·ª© kh√¥ng b·∫Øt bu·ªôc ph·∫£i ·ªü ƒë·∫ßu file):


 The zip file format allows arbitrary data to be prepended to a zip file. The zip application format uses this ability to prepend a standard POSIX ‚Äúshebang‚Äù line to the file (#!/path/to/interpreter).
Formally, the Python zip application format is therefore:

    An optional shebang line, containing the characters b'#!' followed by an interpreter name, and then a newline (b'\n') character. The interpreter name can be anything acceptable to the OS ‚Äúshebang‚Äù processing, or the Python launcher on Windows. The interpreter should be encoded in UTF-8 on Windows, and in sys.getfilesystemencoding() on POSIX.

    Standard zipfile data, as generated by the zipfile module. The zipfile content must include a file called __main__.py (which must be in the ‚Äúroot‚Äù of the zipfile - i.e., it cannot be in a subdirectory). The zipfile data can be compressed or uncompressed.

If an application archive has a shebang line, it may have the executable bit set on POSIX systems, to allow it to be executed directly.

There is no requirement that the tools in this module are used to create application archives - the module is a convenience, but archives in the above format created by any means are acceptable to Python.

<https://docs.python.org/3/library/zipapp.html>

### L√†m m·ªôt app d√πng lib requests, beautifulsoup4
T·∫°o th∆∞ m·ª•c myapp,
t·∫°o file `myapp/__main__.py` v·ªõi n·ªôi dung

```py
from bs4 import BeautifulSoup
import requests
resp = requests.get("https://pymi.vn/")
tree = BeautifulSoup(resp.text, features="lxml")
i_tags = [
    node.text
    for node in tree.find("div", attrs={"role": "alert"}).find_all(
        "li"
    )
]
for msg in i_tags:
    print(msg)
```

Ch·∫°y l·ªánh ƒë·ªÉ c√†i c√°c th∆∞ vi·ªán v√† ƒë√≥ng g√≥i zipapp:

```py
$ python3 -m pip install requests bs4 --target myapp
...
$ ls myapp/
beautifulsoup4-4.11.1.dist-info     idna
bin                                 idna-3.4.dist-info
bs4                                 requests
bs4-0.0.1.egg-info                  requests-2.28.1.dist-info
certifi                             soupsieve
certifi-2022.9.24.dist-info         soupsieve-2.3.2.post1.dist-info
charset_normalizer                  urllib3
charset_normalizer-2.1.1.dist-info  urllib3-1.26.12.dist-info
$ python3 -m zipapp -p "/usr/bin/env python3" myapp
$ ./myapp.pyz
TPHCM üò± D·ª± ki·∫øn khai gi·∫£ng h·ªçc livestream v·ªõi l·ªõp H√† N·ªôi gi·ªØa th√°ng 10 2022 üéâ.
H√† N·ªôi üò± D·ª± ki·∫øn khai gi·∫£ng gi·ªØa th√°ng 10 2022 üéâ.
```

H·∫øt.

ƒêƒÉng k√Ω ngay t·∫°i [PyMI.vn](https://pymi.vn) ƒë·ªÉ h·ªçc Python t·∫°i H√† N·ªôi TP HCM (S√†i G√≤n),
tr·ªü th√†nh l·∫≠p tr√¨nh vi√™n #python chuy√™n nghi·ªáp ngay sau kh√≥a h·ªçc.
